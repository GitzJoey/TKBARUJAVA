<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/mvc"
	xmlns:beans="http://www.springframework.org/schema/beans"
	xmlns:p="http://www.springframework.org/schema/p"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:aop="http://www.springframework.org/schema/aop" 
	xmlns:tx="http://www.springframework.org/schema/tx" 
	xsi:schemaLocation="http://www.springframework.org/schema/mvc
						http://www.springframework.org/schema/mvc/spring-mvc.xsd
						http://www.springframework.org/schema/beans 
						http://www.springframework.org/schema/beans/spring-beans.xsd
						http://www.springframework.org/schema/context
						http://www.springframework.org/schema/context/spring-context.xsd
						http://www.springframework.org/schema/aop 
						http://www.springframework.org/schema/aop/spring-aop.xsd
						http://www.springframework.org/schema/tx 
						http://www.springframework.org/schema/tx/spring-tx.xsd
						">
	
	<!-- Root Context: defines shared resources visible to all other web components -->
    
    <!-- get benefit of annotations -->
    
    <context:annotation-config></context:annotation-config>
     
    <!-- properties file holds database connection parameters -->
    <beans:bean 
    	id="propertyConfigurer" 
    	class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer" 
        p:ignoreResourceNotFound="true">
            <beans:property name="locations">
                <beans:list>
                    <beans:value>/WEB-INF/spring/jdbc.properties</beans:value>
                </beans:list>
            </beans:property>
	</beans:bean>
    
	<!-- configure datasource -->
	<beans:bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
  		<beans:property name="driverClassName" value="${jdbc.driverClassName}" />  
		<beans:property name="url" value="${jdbc.url}" />  
  		<beans:property name="username" value="${jdbc.username}" />  
		<beans:property name="password" value="${jdbc.password}" />  
 	</beans:bean>  

    <beans:bean id="dbcpDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <beans:property name="driverClassName" value="${jdbc.driverClassName}" />
        <beans:property name="url" value="${jdbc.url}" />
        <beans:property name="username" value="${jdbc.username}" />
        <beans:property name="password" value="${jdbc.password}" />
    </beans:bean>

	<!-- Spring Security -->
	<beans:bean id="bCryptPasswordEncoder" class="org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder"/>

	<!-- AOP Proxy Injection Session -->
	<beans:bean id="loginContextSession" class="com.tkbaru.model.LoginContext" scope="session">     
		<aop:scoped-proxy/>
	</beans:bean>

    <!-- Hibernate 4 SessionFactory Bean definition -->
    <beans:bean id="hibernate4AnnotatedSessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
		<beans:property name="dataSource" ref="dbcpDataSource" />
        <beans:property name="annotatedClasses">
            <beans:list>
            	<beans:value>com.tkbaru.model.Customer</beans:value>
                <beans:value>com.tkbaru.model.Supplier</beans:value>
                <beans:value>com.tkbaru.model.Person</beans:value>
                <beans:value>com.tkbaru.model.BankAccount</beans:value>
                <beans:value>com.tkbaru.model.PhoneList</beans:value>
                <beans:value>com.tkbaru.model.Product</beans:value>
                <beans:value>com.tkbaru.model.ProductUnit</beans:value>
                <beans:value>com.tkbaru.model.Store</beans:value>
                <beans:value>com.tkbaru.model.Role</beans:value>
                <beans:value>com.tkbaru.model.Function</beans:value>
                <beans:value>com.tkbaru.model.Stocks</beans:value>
                <beans:value>com.tkbaru.model.Bank</beans:value>
                <beans:value>com.tkbaru.model.Warehouse</beans:value>
                <beans:value>com.tkbaru.model.Lookup</beans:value>
                <beans:value>com.tkbaru.model.Truck</beans:value>
                <beans:value>com.tkbaru.model.Items</beans:value>
                <beans:value>com.tkbaru.model.Payment</beans:value>
                <beans:value>com.tkbaru.model.PurchaseOrder</beans:value>
                <beans:value>com.tkbaru.model.SalesOrder</beans:value>
                <beans:value>com.tkbaru.model.Receipt</beans:value>
                <beans:value>com.tkbaru.model.Price</beans:value>
                <beans:value>com.tkbaru.model.PriceLevel</beans:value>
            </beans:list>
        </beans:property>
        <beans:property name="hibernateProperties">
            <beans:props>
                <beans:prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</beans:prop>
                <beans:prop key="hibernate.show_sql">true</beans:prop>
				<beans:prop key="hibernate.hbm2ddl.auto"></beans:prop>
            </beans:props>
        </beans:property>
        <beans:property name="packagesToScan">
        	<beans:list>
				<beans:value>com.tkbaru.model.Customer</beans:value>
				<beans:value>com.tkbaru.model.Supplier</beans:value>
				<beans:value>com.tkbaru.model.Person</beans:value>
				<beans:value>com.tkbaru.model.BankAccount</beans:value>
				<beans:value>com.tkbaru.model.PhoneList</beans:value>
				<beans:value>com.tkbaru.model.Product</beans:value>
				<beans:value>com.tkbaru.model.ProductUnit</beans:value>
				<beans:value>com.tkbaru.model.Store</beans:value>
				<beans:value>com.tkbaru.model.Role</beans:value>
				<beans:value>com.tkbaru.model.Function</beans:value>
				<beans:value>com.tkbaru.model.Stocks</beans:value>
				<beans:value>com.tkbaru.model.Bank</beans:value>
				<beans:value>com.tkbaru.model.Warehouse</beans:value>
                <beans:value>com.tkbaru.model.Lookup</beans:value>
				<beans:value>com.tkbaru.model.Truck</beans:value>
                <beans:value>com.tkbaru.model.Items</beans:value>
                <beans:value>com.tkbaru.model.Payment</beans:value>
                <beans:value>com.tkbaru.model.PurchaseOrder</beans:value>
                <beans:value>com.tkbaru.model.SalesOrder</beans:value>
                <beans:value>com.tkbaru.model.Receipt</beans:value>
                <beans:value>com.tkbaru.model.Price</beans:value>
                 <beans:value>com.tkbaru.model.PriceLevel</beans:value>
        	</beans:list>
        </beans:property>
    </beans:bean>

	<tx:annotation-driven transaction-manager="transactionManager"/>    
    
    <beans:bean id="transactionManager" class="org.springframework.orm.hibernate4.HibernateTransactionManager">
        <beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
                  
    <!-- declare spring DAO -->
    <beans:bean id="UserDAO" class="com.tkbaru.dao.UserDAOImpl">
    	<beans:property name="dataSource" ref="dataSource" />
    </beans:bean>
    <beans:bean id="FunctionDAO" class="com.tkbaru.dao.FunctionDAOImpl">
    	<beans:property name="dataSource" ref="dataSource" />
    </beans:bean>
	<beans:bean id="PhoneListDAO" class="com.tkbaru.dao.PhoneListDAOImpl">
		<beans:property name="dataSource" ref="dataSource" />
	</beans:bean>
	<beans:bean id="PersonDAO" class="com.tkbaru.dao.PersonDAOImpl">
		<beans:property name="dataSource" ref="dataSource" />
		<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
	</beans:bean>
    <beans:bean id="RoleDAO" class="com.tkbaru.dao.RoleDAOImpl">
    	<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
    <beans:bean id="LookupDAO" class="com.tkbaru.dao.LookupDAOImpl">
    	<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
    <beans:bean id="SupplierDAO" class="com.tkbaru.dao.SupplierDAOImpl">
    	<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
    <beans:bean id="CustomerDAO" class="com.tkbaru.dao.CustomerDAOImpl">
    	<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
    <beans:bean id="ProductDAO" class="com.tkbaru.dao.ProductDAOImpl">
    	<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
    <beans:bean id="StoreDAO" class="com.tkbaru.dao.StoreDAOImpl">
    	<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
    <beans:bean id="StocksDAO" class="com.tkbaru.dao.StocksDAOImpl">
    	<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
    <beans:bean id="BankDAO" class="com.tkbaru.dao.BankDAOImpl">
    	<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
    <beans:bean id="WarehouseDAO" class="com.tkbaru.dao.WarehouseDAOImpl">
    	<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
    <beans:bean id="TruckDAO" class="com.tkbaru.dao.TruckDAOImpl">
    	<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
    <beans:bean id="PurchaseOrderDAO" class="com.tkbaru.dao.PurchaseOrderDAOImpl">
    	<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
    <beans:bean id="SalesOrderDAO" class="com.tkbaru.dao.SalesOrderDAOImpl">
    	<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
     <beans:bean id="PriceDAO" class="com.tkbaru.dao.PriceDAOImpl">
    	<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
    <beans:bean id="PriceLevelDAO" class="com.tkbaru.dao.PriceLevelDAOImpl">
    	<beans:property name="sessionFactory" ref="hibernate4AnnotatedSessionFactory" />
    </beans:bean>
    
    <!-- declare spring Service -->
    <beans:bean id="loginService" class="com.tkbaru.service.LoginServiceImpl">
    	<beans:property name="cryptoBCryptPasswordEncoderManager" ref="bCryptPasswordEncoder" />
    </beans:bean>
    <beans:bean id="userService" class="com.tkbaru.service.UserServiceImpl">
    	<beans:property name="cryptoBCryptPasswordEncoderManager" ref="bCryptPasswordEncoder" />
    </beans:bean>
    <beans:bean id="personService" class="com.tkbaru.service.PersonServiceImpl"></beans:bean>
    <beans:bean id="roleService" class="com.tkbaru.service.RoleServiceImpl"></beans:bean>
    <beans:bean id="functionService" class="com.tkbaru.service.FunctionServiceImpl"></beans:bean>
    <beans:bean id="lookupService" class="com.tkbaru.service.LookupServiceImpl"></beans:bean>
    <beans:bean id="SupplierService" class="com.tkbaru.service.SupplierServiceImpl"></beans:bean>
    <beans:bean id="CustomerService" class="com.tkbaru.service.CustomerServiceImpl"></beans:bean>
    <beans:bean id="ProductService" class="com.tkbaru.service.ProductServiceImpl"></beans:bean>
    <beans:bean id="ReportService" class="com.tkbaru.service.ReportServiceImpl"></beans:bean>
	<beans:bean id="StoreService" class="com.tkbaru.service.StoreServiceImpl"></beans:bean>
	<beans:bean id="StocksService" class="com.tkbaru.service.StocksServiceImpl"></beans:bean>
	<beans:bean id="BankService" class="com.tkbaru.service.BankServiceImpl"></beans:bean>
	<beans:bean id="WarehouseService" class="com.tkbaru.service.WarehouseServiceImpl"></beans:bean>
	<beans:bean id="TruckService" class="com.tkbaru.service.TruckServiceImpl"></beans:bean>
	<beans:bean id="PurchaseOrderService" class="com.tkbaru.service.PurchaseOrderServiceImpl"></beans:bean>
	<beans:bean id="SalesOrderService" class="com.tkbaru.service.SalesOrderServiceImpl"></beans:bean>
	<beans:bean id="SearchService" class="com.tkbaru.service.SearchServiceImpl"></beans:bean>
	<beans:bean id="PriceLevelService" class="com.tkbaru.service.PriceLevelServiceImpl"></beans:bean>
	<beans:bean id="PriceService" class="com.tkbaru.service.PriceServiceImpl"></beans:bean>
	
	<!-- Jasper -->
	<beans:import resource="jasper-views.xml" />
</beans:beans>
